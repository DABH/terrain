trigger:
  - master
  - releases/*

pr:
  - master
  - releases/*

stages:
- stage: Standard_Tests
  jobs:
  - job: Test_SigInt
    strategy:
      matrix:
        linux:
          imageName: "ubuntu-16.04"
      maxParallel: 3
    pool:
      vmImage: $(imageName)
    steps:
      - task: NodeTool@0
        inputs:
          versionSpec: '10.x'
      - script: |
          sudo apt install -y curl wget gnupg jq parallel python-minimal postgresql
          curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
          echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
          sudo apt update
          sudo apt install --no-install-recommends yarn
          ls
          pwd
          yarn
          yarn test-sigint-setup
          cd sigint
          yarn test
          cd ..
        displayName: 'Test SigInt'
